<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="关于CS61A的最后一个项目Scheme的个人解法"><title>CS61A SP24 Scheme</title><link rel=canonical href=https://YuTaki23.github.io/p/cs61a-sp24-scheme/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="CS61A SP24 Scheme"><meta property='og:description' content="关于CS61A的最后一个项目Scheme的个人解法"><meta property='og:url' content='https://YuTaki23.github.io/p/cs61a-sp24-scheme/'><meta property='og:site_name' content="YuTaki's Ideas"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Python'><meta property='article:tag' content='学习笔记'><meta property='article:published_time' content='2025-03-07T00:00:00+00:00'><meta property='article:modified_time' content='2025-03-07T00:00:00+00:00'><meta property='og:image' content='https://YuTaki23.github.io/p/cs61a-sp24-scheme/image1.png'><meta name=twitter:title content="CS61A SP24 Scheme"><meta name=twitter:description content="关于CS61A的最后一个项目Scheme的个人解法"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://YuTaki23.github.io/p/cs61a-sp24-scheme/image1.png'><link rel="shortcut icon" href=/logo.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_b4750235e08b003b.png width=300 height=264 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>&lt;/></span></figure><div class=site-meta><h1 class=site-name><a href=/>YuTaki's Ideas</a></h1><h2 class=site-description>代码与歌</h2></div></header><ol class=menu-social><li><a href=https://github.com/YuTaki23 target=_blank title=GitHub rel=me><svg t="1742388666084" class="icon" viewBox="0 0 1024 1024" p-id="6728" width="200" height="200"><path d="M850.346667 155.008a42.666667 42.666667.0 00-22.741334-23.509333c-8.704-3.754667-85.717333-33.322667-200.32 39.168H396.714667c-114.773333-72.618667-191.701333-42.922667-200.32-39.168a42.88 42.88.0 00-22.741334 23.466666c-26.197333 66.218667-18.048 136.448-7.850666 176.896C134.272 374.016 128 413.098667 128 469.333333c0 177.877333 127.104 227.882667 226.730667 246.272a189.568 189.568.0 00-13.013334 46.549334A44.373333 44.373333.0 00341.333333 768v38.613333c-19.498667-4.138667-41.002667-11.946667-55.168-26.112C238.08 732.416 188.330667 682.666667 128 682.666667V768c25.002667.0 65.365333 40.362667 97.834667 72.832 51.029333 51.029333 129.066667 55.253333 153.386666 55.253333 3.114667.0 5.376-.085333 6.528-.128A42.666667 42.666667.0 00426.666667 853.333333v-82.090666c4.266667-24.746667 20.224-49.621333 27.946666-56.362667A42.666667 42.666667.0 00431.488 640.298667c-138.154667-15.744-218.154667-48.810667-218.154667-170.965334.0-53.12 5.632-70.741333 31.573334-99.285333 11.008-12.117333 14.08-29.568 7.978666-44.8C248.064 313.344 234.112 259.797333 246.4 207.701333c20.650667-1.578667 59.904 4.565333 113.706667 40.96C367.104 253.44 375.466667 256 384 256h256a42.666667 42.666667.0 0023.936-7.338667c54.016-36.522667 92.970667-41.770667 113.664-41.130666 12.330667 52.224-1.578667 105.770667-6.4 117.674666a42.666667 42.666667.0 008.021333 44.928C805.077333 398.464 810.666667 416.085333 810.666667 469.333333c0 122.581333-79.957333 155.52-218.069334 170.922667A42.666667 42.666667.0 00569.472 714.965333C589.269333 732.032 597.333333 747.434666 597.333333 768v128h85.333334V768c0-20.437333-3.925333-38.101333-9.770667-53.12C769.92 695.765333 896 643.712 896 469.333333c0-56.362667-6.272-95.530667-37.76-137.514666C868.437333 291.413334 876.501333 221.312 850.346667 155.008z" fill="#fff" p-id="6729"/></svg></a></li><li><a href=mailto:yutaki23@163.com target=_blank title=邮箱 rel=me><svg t="1742537424403" class="icon" viewBox="0 0 1024 1024" p-id="2705" width="200" height="200"><path d="M838.954667 234.666667h-668.288c-3.626667.0-7.168.448-10.56 1.322666l323.690666 323.669334a21.333333 21.333333.0 0030.165334.0l324.992-324.992zm46.144 14.186666-260.693334 260.693334 262.933334 262.912c5.44-7.168 8.661333-16.106667 8.661333-25.792V277.333333c0-10.944-4.117333-20.906667-10.88-28.48zm-41.237334 540.48-249.6-249.621333L544.128 589.845333a64 64 0 01-90.517333.0l-50.112-50.133333L156.373333 786.88c4.48 1.578667 9.28 2.453333 14.314667 2.453333h673.194667zM128.661333 754.218667l244.672-244.693334-243.754666-243.712A42.709333 42.709333.0 00128 277.333333v469.333334c0 2.56.213333 5.098667.661333 7.552zM170.666667 192h682.666666a85.333333 85.333333.0 0185.333334 85.333333v469.333334A85.333333 85.333333.0 01853.333333 832H170.666667a85.333333 85.333333.0 01-85.333334-85.333333V277.333333A85.333333 85.333333.0 01170.666667 192z" fill="#fff" p-id="2706"/></svg></a></li><li><a href=https://www.zhihu.com/people/yutaki-61 target=_blank title=知乎 rel=me><svg t="1742384826142" class="icon" viewBox="0 0 1024 1024" p-id="2995" width="200" height="200"><path d="M544.949 561.422s0-71.387-34.779-75.05-142.775.0-142.775.0V266.718h161.078s-1.83-73.219-32.949-73.219H233.769l43.93-117.148s-65.897 3.663-89.692 45.761-98.844 252.604-98.844 252.604 25.627 10.983 67.726-20.134c42.101-31.116 56.743-86.033 56.743-86.033l76.879-3.663 1.83 223.316s-133.621-1.83-161.078.0-42.101 75.05-42.101 75.05h203.182s-18.307 124.47-69.557 214.164c-53.085 89.692-151.929 161.078-151.929 161.078s71.387 29.287 140.947-10.983c69.557-42.101 120.811-223.316 120.811-223.316l162.912 203.182s14.643-97.013-1.83-124.47c-18.307-27.457-113.49-137.283-113.49-137.283l-42.101 36.607 29.287-120.811h177.552zM587.05 188.01l-1.83 660.793h65.897l23.795 82.37 115.321-82.37h162.912V188.01H587.054zM879.92 775.584h-76.879l-97.013 75.05-21.965-75.05h-20.134V263.057H879.92v512.527z" fill="#fff" p-id="2996"/></svg></a></li><li><a href=https://space.bilibili.com/45550397 target=_blank title=哔哩哔哩 rel=me><svg t="1742384990540" class="icon" viewBox="0 0 1024 1024" p-id="5704" width="200" height="200"><path d="M278.8864 148.1728c14.336-8.192 32.6144-9.3696 47.8208-2.6624 11.3664 4.6592 19.968 13.824 29.184 21.6064 38.144 32.9216 75.9808 66.304 114.2784 99.0208h80.4352c38.2976-32.768 76.0832-66.048 114.2272-98.9696 9.2672-7.7824 17.8688-16.896 29.2864-21.6576 14.7456-6.5024 32.4608-5.632 46.592 2.048 16.5888 8.5504 28.1088 26.2656 28.8256 44.9536 1.024 13.568-3.84 27.2896-12.3392 37.7856-7.5264 8.3456-16.5376 15.2064-24.8832 22.6816-5.3248 4.4032-10.1376 9.5232-16.0256 13.2096 23.6544.0 47.2576-.256 70.912.1536 31.1296.8192 61.44 14.592 82.8928 37.1712 22.6304 22.2208 35.5328 53.5552 35.4816 85.1968.1024 108.4416.0 216.9344.0512 325.376-.1024 16.384.8192 33.024-2.816 49.152-6.656 32.9728-28.8256 61.5936-56.9856 79.36a121.344 121.344.0 01-64.7168 17.7664H263.2704c-16.9984-.1024-34.2528.8704-50.9952-2.8672-32.1024-6.4512-60.0064-27.648-77.824-54.6304A121.088 121.088.0 01115.2 735.8976v-321.536c.1024-16.5376-.9216-33.1776 2.4576-49.408 10.24-52.9408 58.9312-96.1024 112.9984-98.4576 24.6272-.768 49.3056-.2048 73.9328-.3072-11.6224-8.3968-21.8112-18.5344-32.768-27.7504a55.04 55.04.0 01-20.5312-45.9264c.7168-18.2272 11.6736-35.584 27.648-44.3392m-13.056 221.7984c-20.992 3.7376-38.912 20.3264-44.7488 40.7552a76.4928 76.4928.0 00-2.3552 21.7088c.1024 89.0368-.0512 178.0736.0512 267.1616-.4096 24.2176 16.3328 47.1552 39.1168 54.8864 8.1408 2.9696 16.896 3.0208 25.3952 3.072 153.1904-.1024 306.432.0512 459.6224-.0512 22.4768.8704 44.0832-13.1072 53.5552-33.28 5.7856-11.5712 5.6832-24.7296 5.4784-37.376V438.016c0-9.1136.3072-18.4832-2.304-27.2896a58.7776 58.7776.0 00-36.864-38.656c-9.7792-3.584-20.4288-3.0208-30.6688-3.072H292.5056c-8.8576.0-17.8176-.3072-26.624.9728z" fill="#fff" p-id="5705"/><path d="M358.7072 455.5264c14.6432-1.4848 29.8496 3.2768 41.0112 12.8 12.4416 10.24 19.5584 26.112 19.7632 42.1376.3584 19.4048.1024 38.8608.1024 58.2656.0 12.8-3.3792 25.8048-11.3152 35.9424a54.9888 54.9888.0 01-48.4864 21.76 54.9376 54.9376.0 01-44.032-28.2624c-6.8096-11.6736-7.3728-25.4976-7.168-38.6048.4096-18.8416-1.024-37.7856.8704-56.576a55.296 55.296.0 0149.2544-47.4624zm292.4544.0a55.2448 55.2448.0 0160.7232 53.0432c.8192 18.2272.1024 36.4544.4096 54.6816.1024 12.8-1.4336 26.112-8.4992 37.12-10.24 17.0496-30.3104 27.5456-50.176 26.112a55.04 55.04.0 01-43.3664-24.9856c-7.936-11.776-9.472-26.2656-9.1136-40.0896.3584-18.7392-.6656-37.4784.6144-56.1664 1.8432-25.6 23.9104-47.5136 49.408-49.664z" fill="#fff" p-id="5706"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/gallery/><svg t="1747214407998" class="icon" viewBox="0 0 1024 1024" p-id="3012" width="200" height="200"><path d="M970.98512 120.33229H53.517952c-21.157046.0-38.509848 15.792642-38.509848 35.572926v712.463392c0 19.300137 17.351529 35.318206 38.509848 35.318206H970.98512c20.656521.0 38.009323-16.018069 38.009323-35.318206V155.905216c0-19.785378-17.352802-35.572926-38.009323-35.572926zm-38.484376 712.995757H91.496709v-77.893386L288.72643 573.620597l135.909693 125.230556v.231795l.550196.50944.276371.25472.525997.485242.275097.25472.550196.485242 80.299216 74.403721a25.078461 25.078461.0 0032.550673.0c8.6885-8.533121 8.6885-22.04984.0-30.048049l-65.651541-60.113927 185.563543-171.52847 272.921052 251.918112v67.628168zm0-127.473367L675.824462 468.937031a24.409821 24.409821.0 00-32.525201.0L441.991473 655.258367 304.730489 529.033129a23.252118 23.252118.0 00-31.999204.0L91.496709 695.338564V190.968702h841.004035V705.85468zM303.3792 474.950971c72.962006.0 133.205841-55.5901 133.20584-123.220815.0-67.354344-60.241288-122.711375-133.20584-122.711375-73.232009.0-133.205841 55.357031-133.205841 122.711375.0 67.628168 59.967463 123.220815 133.205841 123.220815zm0-203.357011c48.023641.0 87.635153 36.081093 87.635153 80.136196.0 44.586194-39.608965 81.12833-87.635153 81.12833-47.999443.0-87.610955-36.543409-87.610955-81.12833.0-44.055103 39.608965-80.136196 87.610955-80.136196z" fill="#fff" p-id="3013"/></svg>
<span>Gallery</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://YuTaki23.github.io/ selected>中文</option><option value=https://YuTaki23.github.io/en/>English</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#写在前面>写在前面</a></li><li><a href=#具体思路>具体思路</a><ol><li><a href=#problem-1>Problem 1</a></li><li><a href=#problem-2>Problem 2</a></li><li><a href=#problem-3>Problem 3</a></li><li><a href=#problem-4>Problem 4</a></li><li><a href=#problem-5>Problem 5</a></li><li><a href=#problem-6>Problem 6</a></li><li><a href=#problem-7>Problem 7</a></li><li><a href=#problem-8>Problem 8</a></li><li><a href=#problem-9>Problem 9</a></li><li><a href=#problem-10>Problem 10</a></li><li><a href=#problem-11>Problem 11</a></li><li><a href=#problem-12>Problem 12</a></li><li><a href=#problem-13>Problem 13</a></li><li><a href=#problem-14>Problem 14</a></li></ol></li><li><a href=#写在后面>写在后面</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/cs61a-sp24-scheme/><img src=/p/cs61a-sp24-scheme/image1_hu_488d6c63172aa3ae.png srcset="/p/cs61a-sp24-scheme/image1_hu_488d6c63172aa3ae.png 800w, /p/cs61a-sp24-scheme/image1_hu_ffd769759f18bcd5.png 1600w" width=800 height=459 loading=lazy alt="Featured image of post CS61A SP24 Scheme"></a></div><div class=article-details><header class=article-category><a href=/categories/cs61a/>CS61A
</a><a href=/categories/%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF/>解题思路</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/cs61a-sp24-scheme/>CS61A SP24 Scheme</a></h2><h3 class=article-subtitle>关于CS61A的最后一个项目Scheme的个人解法</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Mar 07, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 10 分钟</time></div></footer></div></header><section class=article-content><h2 id=写在前面>写在前面</h2><p>本项目为UC Berekly CS61A SP24的 Project4: Scheme。以下为个人对此项目的见解，如有错误或更好的解决方案，欢迎与我联系。</p><p><a class=link href=mailto:yutaki23@163.com>点这里向我发邮件~</a></p><h2 id=具体思路>具体思路</h2><h3 id=problem-1>Problem 1</h3><p>首先通读一下题目，此题需要我们完成两个函数<code>define</code>和<code>lookup</code>，同时给了我们关于<code>Frame</code>的一些信息，<code>Frame</code>有两个instance attribute。</p><ol><li><code>bindings</code> 这是一个字典，回顾一下字典的相关内容，字典，相当于其他语言的map，存在一个key和一个value，每个字典当中只能有一个唯一的key，但key中存放的数据可以是相同的。此题中，key就代表的是symbol，而value代表的就是其本意，相当于我们在python当中的等号赋值用法，例如，<code>x = 3</code>在这里key就是x，value就是3。</li><li><code>parent</code> 每个frame都可以被嵌套在另一个frame里面，而他们最终的frame都是None。</li></ol><ul><li><code>define</code></li></ul><p>非常显而易见了，上文中也提到过，在此不再赘述。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>define</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>symbol</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Define Scheme SYMBOL to have VALUE.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>bindings</span><span class=p>[</span><span class=n>symbol</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>lookup</code></li></ul><p>此函数可以想成三个case，题目当中也给了我们很详细的描述。</p><ol><li>若symbol在当前frame里，直接返回value。</li><li>若symbol不在当前frame里，且其含有父frame，且父frame里含有此symbol，返回value。关于这个case，有几点需要说明<ul><li>其含有父frame。问：如何界定此frame是否合法？答：只要不为None，都是合法的。</li><li>父frame里含有symbol。问：如何访问父frame？答：用点表达式访问parent即可。</li></ul></li><li>若均不满足以上情况，即symbol不在当前frame里，且没有父frame，arise error。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>lookup</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>symbol</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Return the value bound to SYMBOL. Errors if SYMBOL is not found.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>current_frame</span> <span class=o>=</span> <span class=bp>self</span>
</span></span><span class=line><span class=cl>        <span class=c1># case1 若symbol在当前frame</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>symbol</span> <span class=ow>in</span> <span class=n>current_frame</span><span class=o>.</span><span class=n>bindings</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>current_frame</span><span class=o>.</span><span class=n>bindings</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>symbol</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># case2 symbol不在当前frame 但在parent frame</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>current_frame</span> <span class=o>=</span> <span class=n>current_frame</span><span class=o>.</span><span class=n>parent</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=n>current_frame</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>symbol</span> <span class=ow>in</span> <span class=n>current_frame</span><span class=o>.</span><span class=n>bindings</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>current_frame</span><span class=o>.</span><span class=n>bindings</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>symbol</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>current_frame</span> <span class=o>=</span> <span class=n>current_frame</span><span class=o>.</span><span class=n>parent</span>
</span></span><span class=line><span class=cl>        <span class=c1># case3 都不存在 引发error</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>SchemeError</span><span class=p>(</span><span class=s1>&#39;unknown identifier: </span><span class=si>{0}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>symbol</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=problem-2>Problem 2</h3><p>首先通读一下题目，此题要求我们实现一个<code>scheme_apply</code>函数中的一个case，即<code>BuiltinProcedure</code>。在完成一个表达式时，存在内置的一些操作如 <code>+ - * /</code>等，在此，就需要我们实现这些操作。</p><p><code>BuiltinProcedure</code>含有两个instance attribute。</p><ol><li><code>py_func</code> 找到对应的操作符号，用python的内置函数来实现表达式，不用我们自己实现（自己似乎也实现不了，有点不切实际）。</li><li><code>need_env</code> 有些内置函数需要特定的环境。</li></ol><p>此题可分为三个步骤来写，题目中也给的很清楚。</p><ol><li>将<code>scheme list</code> 转变为<code>python list</code>，与上题很类似。</li><li>判断<code>need_env</code>的是否，很简单。</li><li>使用*<strong>args表示法</strong>来调用<code>py_func</code>这里可能需要了解一下什么是 *args表示法。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 将scheme list转变为 python list</span>
</span></span><span class=line><span class=cl>            <span class=n>lst</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=n>args</span> <span class=ow>is</span> <span class=ow>not</span> <span class=n>nil</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>lst</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>first</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>args</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>rest</span>
</span></span><span class=line><span class=cl>            <span class=c1># 判断 need_env</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>procedure</span><span class=o>.</span><span class=n>need_env</span> <span class=ow>is</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>lst</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>env</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># 调用 py_func</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>procedure</span><span class=o>.</span><span class=n>py_func</span><span class=p>(</span><span class=o>*</span><span class=n>lst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>TypeError</span> <span class=k>as</span> <span class=n>err</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>SchemeError</span><span class=p>(</span><span class=s1>&#39;incorrect number of arguments: </span><span class=si>{0}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>procedure</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=problem-3>Problem 3</h3><p>此题需要让我们将<code>scheme_eval</code>补充完整，大致题目已给出，我们需要完成的是判断此表达式，并通过上文完成的<code>scheme_apply</code>函数来计算结果。题目还是给了我们大致思路。</p><ol><li>判断<strong>operator</strong>，使用递归。<em>Recrusion</em>，即自身调用自身，那一定是在<code>scheme_eval</code>函数里调用<code>scheme_eval</code>。对于此函数，我们需要三个参数，<code>expresson</code> <code>environment</code>以及一个默认参数，文中给了我们代码提示<code>first = expr.first</code>，由此即可以判断此处的<code>expression = first</code>，同时还要求我们<strong>evaluate to a procedure instance</strong>。<code>scheme_apply</code>的开头就给了我们提示</li><li>判断<strong>operands</strong>，依旧使用递归。与上文类似，题目已经给了我们<code>rest = expr.next</code>，同时题目要求我们收集到scheme列表里，下文有提示，使用<code>Pair</code>的<code>map</code>方法，观察<code>map</code>方法，这提供了一个形参<code>fn</code>，显然此处的<code>fn</code>就是<code>scheme_eval</code>，但<code>scheme_eval</code>存在两个形参，这就需要我们进行转换，使用<strong>lambda函数</strong>。</li><li>之后就是调用<code>scheme_apply</code>，很显然，在此不做过多赘述。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># evaluate operator</span>
</span></span><span class=line><span class=cl>    <span class=n>procedure</span> <span class=o>=</span> <span class=n>scheme_eval</span><span class=p>(</span><span class=n>first</span><span class=p>,</span> <span class=n>env</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>validate_procedure</span><span class=p>(</span><span class=n>procedure</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># evaluate operand</span>
</span></span><span class=line><span class=cl>    <span class=n>operands</span> <span class=o>=</span> <span class=n>rest</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>scheme_eval</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>env</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>scheme_apply</span><span class=p>(</span><span class=n>procedure</span><span class=p>,</span> <span class=n>operands</span><span class=p>,</span> <span class=n>env</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=problem-4>Problem 4</h3><p>此题要求我们实现<code>define</code>，简单来说，就是将一个<strong>expressions</strong>赋值给一个<strong>symbol</strong>。我们在这里只需要实现第一个部分，即计算一个表达式作为<strong>expressions</strong>并复制给一个提供给我们的<strong>symbol</strong>，下方还有提示，需要我们用到<code>Frame</code>里的<code>define</code>。那我们想一想<code>define</code>函数需要我们提供什么参数呢？</p><ol><li><code>symbol</code> symbol总是存在于一个表达式的第一位，函数也给了我们一个提示，即<code>signature = expressions.first</code>，由此我们就可以看出我们的symbol就是这个。</li><li><code>expressions</code> 对于一个表达式来说，我们需要赋值的不仅仅是表达式本身，还是它计算后的数值是什么，所以在这里我们还需要用到上文完成的<code>scheme_eval</code>函数。</li><li>最后，需要我们返回已绑定的<code>symbol</code>。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>signature</span> <span class=o>=</span> <span class=n>expressions</span><span class=o>.</span><span class=n>first</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>scheme_symbolp</span><span class=p>(</span><span class=n>signature</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># assigning a name to a value e.g. (define x (+ 1 2))</span>
</span></span><span class=line><span class=cl>    <span class=n>validate_form</span><span class=p>(</span><span class=n>expressions</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span> <span class=c1># Checks that expressions is a list of length exactly 2</span>
</span></span><span class=line><span class=cl>    <span class=n>env</span><span class=o>.</span><span class=n>define</span><span class=p>(</span><span class=n>signature</span><span class=p>,</span> <span class=n>scheme_eval</span><span class=p>(</span><span class=n>expressions</span><span class=o>.</span><span class=n>rest</span><span class=o>.</span><span class=n>first</span><span class=p>,</span> <span class=n>env</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>signature</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=problem-5>Problem 5</h3><p>此题向我们描述了<code>quote</code>的用法，在此不做过多赘述，详情可看题目要求。在此仅讲讲需要实现的功能。</p><p>给出一段<code>expressions</code>，需要我们原封不动的返回，但对于<code>Pair</code>来说，不返回<strong>nil</strong>，由此可见，需要返回的是<code>expressions.first</code>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>validate_form</span><span class=p>(</span><span class=n>expressions</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=n>expressions</span><span class=o>.</span><span class=n>first</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Congratulation! 第一部分已完成</strong></p><h3 id=problem-6>Problem 6</h3><p>此题我们需要完成Scheme中的一个特殊形式<code>begin</code>。</p><blockquote><p><code>begin</code> 用于按顺序组合多个表达式，并返回最后一个表达式的值。例如，</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-scheme data-lang=scheme><span class=line><span class=cl><span class=p>(</span><span class=nf>begin</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>display </span><span class=s>&#34;Hello&#34;</span><span class=p>)</span>  <span class=c1>; 执行第一个表达式（输出 &#34;Hello&#34;）</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>display </span><span class=s>&#34;World&#34;</span><span class=p>)</span>  <span class=c1>; 执行第二个表达式（输出 &#34;World&#34;）</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>+ </span><span class=mi>1</span> <span class=mi>2</span><span class=p>))</span>          <span class=c1>; 返回最后一个表达式的值 3</span>
</span></span></code></pre></td></tr></table></div></div></blockquote><p>那由此我们可以观察到，它会将所有表达式都执行一遍，但只返回最后一个表达式的值，是不是有点像我们说的递归的概念，不断的完成一个动作，直到最后一个动作再返回。由此我们就可以写出代码。</p><ol><li>首先有一个 <code>base case</code> 若此表达式为空，返回<code>None</code>。</li><li>开始递归。首先我们想一想，想要evaluate一个表达式，应该怎么做？答：用上文完成的<code>scheme_eval</code>函数。</li><li>如何判断是否到达了递归终点？对于一个<code>expressions</code>来说，它就像一个链表，最后一项的<code>rest</code>总是<code>nil</code>，这就到达了递归终点，也就是我们说的<code>base case</code>。</li><li>对于<code>recrusion case</code> 来说，我们要不断的调用自身，直到到达<code>base case</code>。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=n>expressions</span> <span class=ow>is</span> <span class=n>nil</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>exp</span> <span class=o>=</span> <span class=n>scheme_eval</span><span class=p>(</span><span class=n>expressions</span><span class=o>.</span><span class=n>first</span><span class=p>,</span> <span class=n>env</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>expressions</span><span class=o>.</span><span class=n>rest</span> <span class=ow>is</span> <span class=n>nil</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>exp</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>eval_all</span><span class=p>(</span><span class=n>expressions</span><span class=o>.</span><span class=n>rest</span><span class=p>,</span> <span class=n>env</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=problem-7>Problem 7</h3><p>此题依旧需要我们完成Scheme中的一个特殊形式<code>lambda</code>。</p><blockquote><p><code>lambda</code> 用于定义匿名函数，此题要求我们逐步计算表达式，并返回最后一个表达式的值。</p></blockquote><p>其中，<code>LambdaProcedure</code>这个类存在一个实例<code>body</code>，存放的是scheme list，而实例<code>formals</code>存放的是正确的Pair嵌套表达式。</p><p>我们需要做的是创建并返回一个<code>LambdaProcedure</code>实例，那整体思路就很明朗的，再加上此函数还有给我们的提示，使用特定的语法知识，易得。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=n>body</span> <span class=o>=</span> <span class=n>expressions</span><span class=o>.</span><span class=n>rest</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>LambdaProcedure</span><span class=p>(</span><span class=n>formals</span><span class=p>,</span> <span class=n>body</span><span class=p>,</span> <span class=n>env</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=problem-8>Problem 8</h3><p>此题需要我们创建一个新的<code>Frame</code>，其中含有两个参数，<code>formals</code> <code>vals</code>，均为scheme list，需要我们将每一个formal对应到val，且formals于vals的数量都是相等的，一一对应，直到达到scheme list的终点即可。值得注意的是，不是简单的复制父Frame里的内容，笔者在这里第一次就想错了，总的来说，题目已经告诉我们具体做法，在此不做过多赘述。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>        <span class=n>child_frame</span> <span class=o>=</span> <span class=n>Frame</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>formals</span> <span class=ow>is</span> <span class=ow>not</span> <span class=n>nil</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>child_frame</span><span class=o>.</span><span class=n>define</span><span class=p>(</span><span class=n>formals</span><span class=o>.</span><span class=n>first</span><span class=p>,</span> <span class=n>vals</span><span class=o>.</span><span class=n>first</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>formals</span> <span class=o>=</span> <span class=n>formals</span><span class=o>.</span><span class=n>rest</span>
</span></span><span class=line><span class=cl>            <span class=n>vals</span> <span class=o>=</span> <span class=n>vals</span><span class=o>.</span><span class=n>rest</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>child_frame</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=problem-9>Problem 9</h3><p>此题需要我们完成<code>scheme_apply</code>里的一个<code>LambdaProcedure case</code>，题目已经给出提示，即</p><ol><li>创建一个新Frame，注意到，要想创建一个新的Frame，就应该想到用谁来创建，不能是Procedure本身，因为<code>make_child_frame</code>是在Frame类中实现的，所以应该找到一个Frame，即<code>Procedrure.env</code></li><li>将形参绑定到参数值，想一想，对于一个<code>Procedure</code>来说，存在两个实例，即<code>formals</code>和<code>body</code>，而<code>formals</code>对应的就是<code>make_child_frame</code>中的<code>formals</code>，而<code>body</code>对应的就是<code>eval_all</code>中的<code>expressions</code>。</li><li>在当前Frame进行计算，也就是说此时的<code>env</code>应该变成我们创建的新Frame</li></ol><p>综上易得，</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>        <span class=n>child_frame</span> <span class=o>=</span> <span class=n>procedure</span><span class=o>.</span><span class=n>env</span><span class=o>.</span><span class=n>make_child_frame</span><span class=p>(</span><span class=n>procedure</span><span class=o>.</span><span class=n>formals</span><span class=p>,</span> <span class=n>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>eval_all</span><span class=p>(</span><span class=n>procedure</span><span class=o>.</span><span class=n>body</span><span class=p>,</span> <span class=n>child_frame</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=problem-10>Problem 10</h3><p>此题需要我们完成<code>define</code>的一种新类型，题目已经给了详尽的步骤，在这里讲几个笔者踩到的坑。</p><ol><li>想清楚<code>symbol</code> <code>formals</code> <code>body</code>分别代表什么，首先想明白，signature与expression之间的关系，signature代表的是expression的第一个内容，也就是函数名，而其中<code>symbol</code>也叫函数，也就是<code>signature.first</code>，之后再想想<code>formals</code>，就是除了define和函数名剩下的内容，而<code>body</code>则代表的是除了define之外的所有内容，想清楚这五个之间的关系，对于这道题十分关键。</li><li>题目告诉我们可以使用<code>do_lambda_form</code>，但笔者试了很多次也没有找到方法，若有人有更好的意见欢迎与我联系。</li><li>在找到正确的<code>formals</code>后还需要使用<code>validate_formals()</code>函数来判断其正确性。</li></ol><p>综上可知，</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>        <span class=n>symbol</span> <span class=o>=</span> <span class=n>signature</span><span class=o>.</span><span class=n>first</span>
</span></span><span class=line><span class=cl>        <span class=n>formals</span> <span class=o>=</span> <span class=n>signature</span><span class=o>.</span><span class=n>rest</span>
</span></span><span class=line><span class=cl>        <span class=n>validate_formals</span><span class=p>(</span><span class=n>formals</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>body</span> <span class=o>=</span> <span class=n>expressions</span><span class=o>.</span><span class=n>rest</span>
</span></span><span class=line><span class=cl>        <span class=n>env</span><span class=o>.</span><span class=n>define</span><span class=p>(</span><span class=n>symbol</span><span class=p>,</span> <span class=n>LambdaProcedure</span><span class=p>(</span><span class=n>formals</span><span class=p>,</span> <span class=n>body</span><span class=p>,</span> <span class=n>env</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>symbol</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=problem-11>Problem 11</h3><p>这道题看着题目很长很难，但其实是纸老虎，根据它的题意来即可。</p><ol><li>看看<code>MuProcedure</code>可以发现需要两个参数，<code>formals</code>和<code>body</code>，<code>formals</code>题目已经给出，指的是expressions的第一个内容，而<code>body</code>就是除了第一个内容的其他内容。</li><li>完成<code>scheme_apply</code>的<code>mu case</code>，这个内容跟上文的<code>lambda case</code>如出一辙，有区别的是，Frame的区别，因为<code>mu</code>是动态的，所以它的Frame一直在变，就不需要再用Procedure的Frame了。</li></ol><p>综上可知，</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>return</span> <span class=n>MuProcedure</span><span class=p>(</span><span class=n>formals</span><span class=p>,</span> <span class=n>expressions</span><span class=o>.</span><span class=n>rest</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>        <span class=n>child_frame</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>make_child_frame</span><span class=p>(</span><span class=n>procedure</span><span class=o>.</span><span class=n>formals</span><span class=p>,</span> <span class=n>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>eval_all</span><span class=p>(</span><span class=n>procedure</span><span class=o>.</span><span class=n>body</span><span class=p>,</span> <span class=n>child_frame</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Part 2 已完成！</strong></p><h3 id=problem-12>Problem 12</h3><p>这道题需要我们完成两个函数<code>do_and_form</code>和<code>do_or_form</code>，这两个函数从形式上来说都很相似，所以放在一起做，读题目可知，expressions会给出不定量个内容，我们需要判断每个内容的正确性来判断应返回什么，值得注意的是，对于<code>and</code>和<code>or</code>来说，存在一个关键的地方<strong>短路</strong>，每当遇到一个合适的内容时，就会舍弃后面的所有内容，仅返回当前内容。</p><p>因此，对于此题来说，递归是个很好的办法，具体步骤如下。</p><ol><li><code>base case 1</code> 若expression为空，则返回特定值。</li><li><code>base case 2</code> 每当我们判断出来的当前内容的正确性，则直接返回。</li><li><code>base case 3</code> 当所有内容都判断完毕后还没有找到正确性，则返回最后一个内容。</li><li><code>recrusion case</code> 不断对下一个内容执行当前函数。</li></ol><p>代码如下，</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>do_and_form</span><span class=p>(</span><span class=n>expressions</span><span class=p>,</span> <span class=n>env</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>expressions</span> <span class=ow>is</span> <span class=n>nil</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>currency</span> <span class=o>=</span> <span class=n>scheme_eval</span><span class=p>(</span><span class=n>expressions</span><span class=o>.</span><span class=n>first</span><span class=p>,</span> <span class=n>env</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>is_scheme_true</span><span class=p>(</span><span class=n>currency</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>expressions</span><span class=o>.</span><span class=n>rest</span> <span class=ow>is</span> <span class=n>nil</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>currency</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>do_and_form</span><span class=p>(</span><span class=n>expressions</span><span class=o>.</span><span class=n>rest</span><span class=p>,</span> <span class=n>env</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>currency</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>do_or_form</span><span class=p>(</span><span class=n>expressions</span><span class=p>,</span> <span class=n>env</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>expressions</span> <span class=ow>is</span> <span class=n>nil</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>currency</span> <span class=o>=</span> <span class=n>scheme_eval</span><span class=p>(</span><span class=n>expressions</span><span class=o>.</span><span class=n>first</span><span class=p>,</span> <span class=n>env</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>is_scheme_false</span><span class=p>(</span><span class=n>currency</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>expressions</span><span class=o>.</span><span class=n>rest</span> <span class=ow>is</span> <span class=n>nil</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>currency</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>do_or_form</span><span class=p>(</span><span class=n>expressions</span><span class=o>.</span><span class=n>rest</span><span class=p>,</span> <span class=n>env</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>currency</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=problem-13>Problem 13</h3><p>此题需要我们完成<code>cond</code>，题目也给了我们描述。返回第一个表达式为<code>true</code>的值，若都不是正确的，那么就返回<code>else</code>表达式也就是最后一个表达式的值，这也是一个递归步骤，因此可知步骤为，</p><ol><li><code>base case</code> 判断到最后一个表达式，若还没有判断出来，则返回此表达式的值。</li><li><code>recrusion case</code> 从第一个表达式开始逐步判断。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>            <span class=k>if</span> <span class=n>clause</span><span class=o>.</span><span class=n>rest</span> <span class=ow>is</span> <span class=n>nil</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>test</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>eval_all</span><span class=p>(</span><span class=n>clause</span><span class=o>.</span><span class=n>rest</span><span class=p>,</span> <span class=n>env</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=problem-14>Problem 14</h3><p><strong>这道题确实没看懂什么意思，在此也不误人子弟了。</strong></p><p><a class=link href=https://github.com/YuTaki23/CS61A-SP24 target=_blank rel=noopener>点这里看总的代码实现</a></p><h2 id=写在后面>写在后面</h2><p>后续的题目就不再做了，是关于Scheme的。</p><p>作为UCB的CS61系列的第一门课，在当时还是初学者的我留下了很深的心理阴影，Scheme这个项目也一直停着没有做，这次重新捡回来，也算是给自己的一个交代。</p><p>至此，CS61A结束。</p><p align=right>YuTaki</p><p align=right>2025年3月7日写于博学楼</p></section><footer class=article-footer><section class=article-tags><a href=/tags/python/>Python</a>
<a href=/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/>学习笔记</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main-article");renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/cs61c-fa20-lab03-lab04/><div class=article-details><h2 class=article-title>CS61C FA20 Lab03-Lab04</h2></div></a></article><article><a href=/p/cs61c-fa20-project1/><div class=article-details><h2 class=article-title>CS61C FA20 Project1</h2></div></a></article><article><a href=/p/cs144-winter2025-check0/><div class=article-details><h2 class=article-title>CS144 Winter2025 Check0</h2></div></a></article><article><a href=/p/cs61c-fa20-lab01-lab02/><div class=article-details><h2 class=article-title>CS61C FA20 Lab01-Lab02</h2></div></a></article><article><a href=/p/cs106l-winter2025-assignment7-unique-pointer/><div class=article-details><h2 class=article-title>CS106L Winter2025 Assignment7 Unique Pointer</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=YuTaki23/YuTaki23.github.io data-repo-id=R_kgDOOLOVVw data-category=Announcements data-category-id=DIC_kwDOOLOVV84CpOPn data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark_dimmed")}})()</script><footer class=site-footer><section class=copyright>&copy;
2025 YuTaki. All rights reserved.</section><section class=powerby>不会摄影的药师不是好程序员<br>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>